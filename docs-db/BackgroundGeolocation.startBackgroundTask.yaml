id: BackgroundGeolocation.startBackgroundTask
source_file: background-geolocation-types/src/core/api/BackgroundGeolocation.ts
signature: 'startBackgroundTask(): Promise<number>;'
description: |-
  Sends a signal to OS that you wish to perform a long-running task.

  The OS will keep your running in the background and not suspend it until you signal completion with the {@link stopBackgroundTask} method.  Your callback will be provided with a single parameter `taskId`
  which you will send to the {@link stopBackgroundTask} method.

  @example example-1

  __iOS:__
  The iOS implementation uses [beginBackgroundTaskWithExpirationHandler](https://developer.apple.com/documentation/uikit/uiapplication/1623031-beginbackgroundtaskwithexpiratio)

  ⚠️ iOS provides **exactly** 180s of background-running time.  If your long-running task exceeds this time, the plugin has a fail-safe which will
  automatically {@link stopBackgroundTask} your **`taskId`** to prevent the OS from force-killing your application.

  Logging of iOS background tasks looks like this:
  ```
  ✅-[BackgroundTaskManager createBackgroundTask] 1
  .
  .
  .

  ✅-[BackgroundTaskManager stopBackgroundTask:]_block_invoke 1 OF (
      1
  )
  ```
  __Android:__

  The Android implementation launches a [`WorkManager`](https://developer.android.com/topic/libraries/architecture/workmanager) task.

  ⚠️ The Android plugin imposes a limit of **3 minutes** for your background-task before it automatically `FORCE KILL`s it.


  Logging for Android background-tasks looks like this (when you see an hourglass ⏳ icon, a foreground-service is active)
  ```
   I TSLocationManager: [c.t.l.u.BackgroundTaskManager onStartJob] ⏳ startBackgroundTask: 6
   .
   .
   .
   I TSLocationManager: [c.t.l.u.BackgroundTaskManager$Task stop] ⏳ stopBackgroundTask: 6
  ```
examples:
  example-1:
    title: Example 1
    code:
      ts: |-
        onLocation(location) {
          console.log("[location] ", location);

          // Perform some long-running task (eg: HTTP request)
          BackgroundGeolocation.startBackgroundTask().then((taskId) => {
            performLongRunningTask.then(() => {
              // When your long-running task is complete, signal completion of taskId.
              BackgroundGeolocation.stopBackgroundTask(taskId);
            }).catch(error) => {
              // Be sure to catch errors:  never leave you background-task hanging.
              console.error(error);
              BackgroundGeolocation.stopBackgroundTask();
            });
          });
        }
